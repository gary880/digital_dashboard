<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media</title>
    <link rel="stylesheet" href="./CSS/media.css">
    <script src="https://kit.fontawesome.com/2681f9c92c.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <div class="player">
            <video class="player__video viewer" src=""></video>
            <div class="player__controls">
              <div class="progress">
               <div class="progress__filled"></div>
              </div>
              <button class="player__button toggle" title="Toggle Play">►</button>
              <input type="range" name="volume" class="player__slider" min="0" max="1" step="0.05" value="1">
              <input type="range" name="playbackRate" class="player__slider" min="0.5" max="2" step="0.1" value="1">
              <button data-skip="-10" class="player__button">« 10s</button>
              <button data-skip="25" class="player__button">25s »</button>
            </div>
          </div>
          <a href="./index.html"id="back"><i class="fas fa-undo" style="text-decoration: none;font-size: 30px;"></i></a>
    </div>
    
   <script>
       //get elements
const player = document.querySelector('.player');
const video = player.querySelector('.viewer');
const progress = player.querySelector('.progress');
const progressBar = player.querySelector('.progress__filled');
const toggle = player.querySelector('.toggle');
const skipbutton = player.querySelectorAll('[data-skip]');
const ranges = player.querySelectorAll('.player__slider');


//build function
function togglePlay() {
    const toggleplay = video.paused ? 'play' : 'pause';
    video[toggleplay]();
}

function updateBtn() {
    const Btn = video.paused ? toggle.textContent = '►' : toggle.textContent = '❚ ❚';
    // if(this.paused){ 
    //     toggle.textContent = '►';
    // }else{
    //     toggle.textContent = '❚ ❚';
    // }
}

function skipBtn() {

    // console.log(this.dataset.skip);
    let skiptime = parseFloat(this.dataset.skip);
    video.currentTime += skiptime;

}
function updateRange() {
    //    if(this.name == 'volume'){
    //        video.volume = this.value;
    //    }else if(this.name == 'playbackRate'){
    //        video.playbackRate = this.value;
    //    }
    video[this.name] = this.value;

}
function updateProgressbar() {
    let Percentage = (video.currentTime / video.duration) * 100;
    progressBar.style['flex-basis'] = Percentage + '%';

}

function VideoProgress(e) {

    let Percentage = (e.offsetX / progress.offsetWidth);
    video.currentTime = video.duration * Percentage;

}
//hook up the event listeners

video.addEventListener('click', togglePlay);
video.addEventListener('play', updateBtn);
video.addEventListener('pause', updateBtn);
toggle.addEventListener('click', togglePlay);
ranges.forEach(range => range.addEventListener('change', updateRange));
ranges.forEach(range => range.addEventListener('mousemove', updateRange));
skipbutton.forEach(Btn => Btn.addEventListener('click', skipBtn));
video.addEventListener('timeupdate', updateProgressbar);
let mousedown = false;
progress.addEventListener('click', VideoProgress);

progress.addEventListener('mousedown', () => mousedown = true);


progress.addEventListener('mouseup', () => mousedown = false);

// progress.addEventListener('mousemove', function(e){
//     if (mousedown) {
//         VideoProgress(e);
//     } else {
//         return;
//     }
// });
progress.addEventListener('mousemove',(e)=> mousedown && VideoProgress(e));



   </script>
</body>
</html>